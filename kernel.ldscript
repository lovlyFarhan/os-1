/* Script for -z combreloc: combine and sort reloc sections */
OUTPUT_FORMAT("elf32-littlearm", "elf32-bigarm",
	      "elf32-littlearm")
OUTPUT_ARCH(arm)
ENTRY(_start)
SEARCH_DIR("/opt/local/arm-none-eabi/lib");
SECTIONS
{
    __KernelStart = 3 * 1024 * 1024 * 1024;
    __PhysicalRamSize = 256 * 1024 * 1024;

    . = 0x0;

    .early.text :
        {
        early-*.o(.text)
        }

    .early.data :
        {
        early-*.o(.data .data.*)
        early-*.o(.bss .bss.*)
        }

    . = ALIGN(CONSTANT(MAXPAGESIZE));
    begin_high = .;

    .text (begin_high + __KernelStart) : AT(begin_high)
        ALIGN(CONSTANT(MAXPAGESIZE))
        {
            *(.text)
        }

    .data :
        ALIGN(CONSTANT(MAXPAGESIZE))
        {
            *(.data)
            *(.rodata)
        }

    .bss :
        ALIGN(CONSTANT(MAXPAGESIZE))
        {
            *(.bss)
        }

    __HeapStart = ALIGN(CONSTANT(MAXPAGESIZE));
    __RamEnd = __KernelStart + __PhysicalRamSize;

    .vector 0xffff0000 : AT(ALIGN(LOADADDR(.bss) + SIZEOF(.bss), 65536))
        {
            __VectorStartPhysical = LOADADDR(.vector);
            *(.text.vector)
            __VectorEndPhysical = . - (ADDR(.vector) - LOADADDR(.vector));
        }
}
